{% extends 'base.html' %}
{% block content %}
<div class="container mt-4">

  <!-- Header -->
  <div class="d-flex flex-wrap justify-content-between align-items-center gap-2 mb-3">
    <h3 class="mb-0">ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ù…Ø³ØªÙˆØ¯Ø¹: {{ warehouse.name }}</h3>

    <a href="{% url 'inventory:warehouse_list' %}" class="btn btn-secondary btn-sm">
      â†© Ø±Ø¬ÙˆØ¹ Ù„Ù„Ù…Ø³ØªÙˆØ¯Ø¹Ø§Øª
    </a>
  </div>

  <!-- Actions -->
  <div class="card shadow-sm mb-4">
    <div class="card-body">
      <div class="d-flex flex-wrap justify-content-center gap-2">

        <!-- Ø¹Ù…Ù„ÙŠØ§Øª -->
        <a href="{% url 'inventory:warehouse_stock_add' warehouse.pk %}" class="btn btn-success btn-sm">
          â• Ø¥Ø¶Ø§ÙØ© Ù…Ø®Ø²ÙˆÙ†
        </a>
        <a href="{% url 'inventory:warehouse_stock_remove' warehouse.pk %}" class="btn btn-danger btn-sm">
          â– Ø³Ø­Ø¨ Ù…Ø®Ø²ÙˆÙ†
        </a>
        <a href="{% url 'inventory:warehouse_movement_add' warehouse.pk %}" class="btn btn-warning btn-sm">
          ğŸ§¾ ØªØ³Ø¬ÙŠÙ„ Ø­Ø±ÙƒØ©
        </a>

        {# Ø¥Ø°Ø§ Ø¹Ù†Ø¯Ùƒ URL Ù„Ù„ØªØ­ÙˆÙŠÙ„ Ø®Ù„ÙŠÙ‡Ø§ØŒ Ø¥Ø°Ø§ Ù„Ø§ Ø§Ø­Ø°ÙÙŠ Ø§Ù„Ø³Ø·Ø± #}
        <a href="{% url 'inventory:warehouse_transfer' warehouse.pk %}"
         class="btn btn-outline-dark btn-sm">
        ğŸ” ØªØ­ÙˆÙŠÙ„ Ù„Ù…Ø³ØªÙˆØ¯Ø¹ Ø¢Ø®Ø±
        </a>


        

        <span class="mx-2 d-none d-md-inline">|</span>

        <!-- ØªØµØ¯ÙŠØ± Ø§Ù„Ù…Ø®Ø²ÙˆÙ† -->
        <a href="{% url 'inventory:export_warehouse_pdf' warehouse.pk %}" class="btn btn-outline-danger btn-sm">
          PDF Ù…Ø®Ø²ÙˆÙ†
        </a>
        <a href="{% url 'inventory:export_warehouse_excel' warehouse.pk %}" class="btn btn-outline-primary btn-sm">
          Excel Ù…Ø®Ø²ÙˆÙ†
        </a>
        <a href="{% url 'inventory:export_warehouse_csv' warehouse.pk %}" class="btn btn-outline-success btn-sm">
          CSV Ù…Ø®Ø²ÙˆÙ†
        </a>

        <!-- ØªØµØ¯ÙŠØ± Ø§Ù„Ø­Ø±ÙƒØ§Øª -->
        <a href="{% url 'inventory:export_warehouse_movements_pdf' warehouse.pk %}" class="btn btn-dark btn-sm">
          ğŸ§¾ PDF Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª
        </a>

      </div>
    </div>
  </div>

  <!-- STOCK -->
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h5 class="mb-0">Ø§Ù„Ù…Ø®Ø²ÙˆÙ†</h5>
    <span class="badge bg-dark">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„ÙƒÙ…ÙŠØ©: {{ total_qty }}</span>
  </div>

  <div class="table-responsive mb-5">
    <table class="table table-bordered text-center table-striped align-middle">
      <thead class="table-dark">
        <tr>
          <th style="width:60px">#</th>
          <th>Ø§Ø³Ù… Ø§Ù„Ù…Ù†ØªØ¬</th>
          <th style="width:160px">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th style="width:220px">Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
        </tr>
      </thead>
      <tbody>
        {% for s in stocks %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td class="text-start">{{ s.product.name }}</td>
            <td><strong>{{ s.quantity }}</strong></td>
            <td>
              <a href="{% url 'inventory:warehouse_stock_edit' s.pk %}" class="btn btn-outline-warning btn-sm">ØªØ¹Ø¯ÙŠÙ„</a>
              <a href="{% url 'inventory:warehouse_stock_delete' s.pk %}" class="btn btn-outline-danger btn-sm">Ø­Ø°Ù</a>
            </td>
          </tr>
        {% empty %}
          <tr><td colspan="4">Ù„Ø§ ÙŠÙˆØ¬Ø¯ Ù…Ø®Ø²ÙˆÙ†.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  <!-- MOVEMENTS -->
  <div class="d-flex justify-content-between align-items-center mb-2">
    <h5 class="mb-0">Ø³Ø¬Ù„ Ø§Ù„Ø­Ø±ÙƒØ§Øª</h5>
  </div>

  <div class="table-responsive">
    <table class="table table-bordered text-center table-striped align-middle">
      <thead class="table-dark">
        <tr>
          <th style="width:60px">#</th>
          <th>Ø§Ù„Ù…Ù†ØªØ¬</th>
          <th style="width:140px">Ù†ÙˆØ¹ Ø§Ù„Ø­Ø±ÙƒØ©</th>
          <th style="width:140px">Ø§Ù„ÙƒÙ…ÙŠØ©</th>
          <th style="width:200px">Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          <th>Ù…Ù„Ø§Ø­Ø¸Ø§Øª</th>
        </tr>
      </thead>
      <tbody>
        {% for m in movements %}
          <tr>
            <td>{{ forloop.counter }}</td>
            <td class="text-start">{{ m.product.name }}</td>
            <td>
              {% if m.movement_type == 'Ø¥Ø¶Ø§ÙØ©' %}
                <span class="badge bg-success">Ø¥Ø¶Ø§ÙØ©</span>
              {% elif m.movement_type == 'Ø³Ø­Ø¨' %}
                <span class="badge bg-danger">Ø³Ø­Ø¨</span>
              {% else %}
                <span class="badge bg-secondary">{{ m.movement_type }}</span>
              {% endif %}
            </td>
            <td><strong>{{ m.quantity }}</strong></td>
            <td>{{ m.date|date:'Y-m-d H:i' }}</td>
            <td class="text-start">{{ m.notes|default:"â€”" }}</td>
          </tr>
        {% empty %}
          <tr><td colspan="6">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø­Ø±ÙƒØ§Øª.</td></tr>
        {% endfor %}
      </tbody>
    </table>
  </div>

  {% if movements.has_other_pages %}
    <div class="d-flex justify-content-center mt-3">
      <nav>
        <ul class="pagination">

          {% if movements.has_previous %}
            <li class="page-item">
              <a class="page-link" href="?mov_page={{ movements.previous_page_number }}">Ø§Ù„Ø³Ø§Ø¨Ù‚</a>
            </li>
          {% endif %}

          <li class="page-item disabled">
            <span class="page-link">ØµÙØ­Ø© {{ movements.number }} Ù…Ù† {{ movements.paginator.num_pages }}</span>
          </li>

          {% if movements.has_next %}
            <li class="page-item">
              <a class="page-link" href="?mov_page={{ movements.next_page_number }}">Ø§Ù„ØªØ§Ù„ÙŠ</a>
            </li>
          {% endif %}

        </ul>
      </nav>
    </div>
  {% endif %}

</div>
{% endblock %}
